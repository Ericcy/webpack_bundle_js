<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>埋点测试页</title>
</head>
<body>
    <h1>dispatchid<em>哈哈哈哈哈哈</em></h1>
    <a href="demo1.html">demo1</a>
    <div class="login">
        <p>模拟登陆</p>
        <button id="login">登陆</button>
    </div>
    <script src="./dfsta.js"></script>
    <script>
        var clickDom = document.getElementById('clickDom');
        var dfCollect = new DF_SDK_Collect({sendUrl: 'http://www.baidu.com',commonUpData:{plantform:'zs'}});
        dfCollect.pageVisit({userId:'2222'});
        // 不需要传参数的情况
        // dfCollect.setIntervalPv(dfCollect.pageVisit,1000);
        // 需要传参数的情况
        dfCollect.setIntervalPv(()=>{dfCollect.pageVisit({userId:'1111'})},1000);

        //点击上报
        var clickUpHander = function () {
            window.addEventListener('click', function (e) {
                dfCollect.clickHandler({
                    eventType: 'click'
                });
            }, false)
        }
        clickUpHander()




        //初始化上报
        dfCollect.upPv = function(){
            dfCollect.pageVisit();
        }
        //定时上报
        dfCollect.timeUpHandle = function(){
            var that = this;
            var up = window.setInterval(that.upPv, 3000);
            document.addEventListener('visibilitychange', function(){
                if(document.hidden){
                    window.clearInterval(up);
                }else{
                    up = window.setInterval(that.upPv, 3000);
                }
            })
        }
        
        //初始化方法
        dfCollect.init = function(){
            this.upPv();
            this.timeUpHandle();
            this.clickUpHander('click');
        }

        // dfCollect.init();
    </script>
</body>
</html>